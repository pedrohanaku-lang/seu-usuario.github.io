<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evite as Balas</title>
    <style>
        body { margin:0; padding:0; background:#111; color:#0f0; font:Arial, sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; }
        canvas { background:#0a0a0a; border:3px solid #0f0; image-rendering:pixelated; }
        #menu, #creditos { position:absolute; text-align:center; color:#0f0; }
        button { background:#000; color:#0f0; border:2px solid #0f0; padding:15px 40px; font:1.5em; margin:20px; cursor:pointer; }
        button:hover { background:#0f0; color:#000; }
        #cart if (enemy.isBoss) {
    enemy.hp--;
    if (enemy.hp <= 0) {
        enemies.splice(j,1);
        showCardSelection();
        return;
    }
}<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Evite as Balas</title>
<style>
body{margin:0;background:#111;color:#0f0;font:Arial;display:flex;justify-content:center;align-items:center;height:100vh;}
canvas{border:3px solid #0f0;background:#000;display:none;}
#menu,#creditos,#cartas{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#000;border:2px solid #0f0;padding:40px;color:#0f0;text-align:center;}
#cartas{top:40%;width:600px;height:auto;display:flex;gap:20px;justify-content:center;flex-wrap:wrap;}
.cartao{background:#111;border:2px solid #0f0;padding:20px;width:120px;cursor:pointer;font-size:1.1em;}
.cartao:hover{background:#0f0;color:#000;}
button{background:#0f0;color:#000;border:2px solid #0f0;padding:12px 30px;font-size:1.3em;cursor:pointer;margin:10px;}
button:hover{background:#fff;}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="menu"><h1>EVITE AS BALAS</h1><button onclick="start()">JOGAR</button><button onclick="showCréditos()">CRÉDITOS</button></div>
<div id="creditos" style="display:none"><h2>CRÉDITOS</h2><p>Scripter: Hanako</p><p>Design: Barros</p><button onclick="back()">VOLTAR</button></div>
<div id="cartas" style="display:none"></div>

<script>
c=document.getElementById('c');ctx=c.getContext('2d');c.width=800;c.height=600;
let gameActive=false,showingCards=false,killCount=0,maxLives=3,currentLives=3,doubleShot=false,swordRange=70;
let player,enemies=[],bulletPlayer=[ ],score=0,difficulty=1;
let keys={},mouseX=c.width/2,mouseY=c.height/2;

function start(){
    document.getElementById('menu').style.display='none';
    c.style.display='block';
    resetGame();
    gameActive=true;
    spawnEnemy();
}
function resetGame(){
    player={x:100,y:300,width:30,height:30,speed:5,color:'#0f0'};
    enemies=bulletPlayer=bulletEnemy=[];
    score=killCount=0;
    currentLives=maxLives;
    difficulty=1;
}
function showCréditos(){document.getElementById('menu').style.display='none';document.getElementById('creditos').style.display='block';}
function back(){document.getElementById('creditos').style.display='none';document.getElementById('menu').style.display='block';c.style.display='none';}
function gameOver(){gameActive=false;draw();ctx.fillStyle='rgba(0,0,0,.9)';ctx.fillRect(0,0,800,600);drawText('GAME OVER','center',250,'50px','#f00');drawText(`Score: ${score}`,'center',350,'30px','#ff0');drawText('R = menu','center',450,'20px');}
function drawText(txt,x,y,s='20px',col='#0f0'){ctx.font=s;ctx.fillStyle=col;ctx.textAlign='center';ctx.fillText(txt,x,y);ctx.textAlign='left';}

window.onkeydown=e=>{keys =1};
window.onkeyup=e=>{keys =0};
c.oncontextmenu=e=>e.preventDefault();
c.onmousedown=e=>{if(e.button===2)shoot()};
c.onmousemove=e=>{let r=c.getBoundingClientRect();mouseX=e.clientX-r.left;mouseY=e.clientY-r.top;}

function shoot(){let b=new Bullet(player.x+15,player.y+15,mouseX,mouseY,'#f44',7);bulletPlayer.push(b);if(doubleShot)setTimeout(shoot,50);}
function sword(){for(let i=enemies.length-1;i>=0;i--){let e=enemies ;let d=Math.hypot(e.x-player.x,e.y-player.y);if(d<swordRange){killEnemy(i);return}}for(let i=bulletEnemy.length-1;i>=0;i--){let b=bulletEnemy ;let d=Math.hypot(b.x-player.x,b.y-player.y);if(d<swordRange+20)bulletEnemy.splice(i,1);}}
function spawnEnemy(){let x=Math.random()*800,y=Math.random()*600;enemies.push({x,y,width:30,height:30,color:'#f0f',shootTimer:0,shootInterval:60,velocity:{vx:Math.random()*2-1,vy:Math.random()*2-1}});}
function spawnBoss(){enemies.push({x:400-80,y:50,width:160,height:160,color:'#400',hp:100,isBoss:1,shootTimer:0,shootInterval:30,velocity:{vx:0,vy:1.5}});}
function killEnemy(i){killCount++;let e=enemies.splice(i,1)[0];if(e.isBoss){showingCards=true;openCards();}else{score+=10;if(killCount%20===0)spawnBoss();else spawnEnemy();}}

class Bullet{constructor(x,y,tx,ty,c,s){this.x=x;this.y=y;let dx=tx-x,dy=ty-y,d= Math.hypot(dx,dy)||1;this.vx=dx/d*s;this.vy=dy/d*s;this.color=c;this.size=8;}update(){this.x+=this.vx;this.y+=this.vy;}draw(){ctx.fillStyle=this.color;ctx.fillRect(this.x-4,this.y-4,8,8);}off(){return this.x<-20||this.x>820||this.y<-20||this.y>620;}}
function update(){
    if(keys[' ']){sword();}
    if(keys.w||keys.ArrowUp)player.y-=player.speed;
    if(keys.s||keys.ArrowDown)player.y+=player.speed;
    if(keys.a||keys.ArrowLeft)player.x-=player.speed;
    if(keys.d||keys.ArrowRight)player.x+=player.speed;
    player.x=Math.max(0,Math.min(770,player.x));
    player.y=Math.max(0,Math.min(570 player.y = Math.max(0, Math.min(570, player.y));

enemies.forEach((e, i) => {
    e.x += e.velocity.vx;
    e.y += e.velocity.vy;
    
    if (e.isBoss) {
        e.shootTimer++;
        if (e.shootTimer >= e.shootInterval) {
            let bx = e.x + 80, by = e.y + 80;
            for (let k = 0; k < 8; k++) {
                let ang = k * Math.PI / 4;
                bullet // loop de tiros do boss
let ang = k * Math.PI / 4;
let tx = bx + Math.cos(ang) * 500;
let ty = by + Math.sin(ang) * 500;
bulletEnemy.push(new Bullet(bx, by, tx, ty, '#f4f', 4 + difficulty * 0.3));
}
e.shootTimer = 0;
} else {
// inimigo normal atira
e.shootTimer++;
if (e.shootTimer >= e.shootInterval) {
bulletEnemy.push(new Bullet(
e.x + 15, e.y + 15,
player.x + 15, player.y + 15, '#44f', 5
));
e.shootTimer = 0;
}
}
});

// atualizar balas .forEach(arry => {
for (let i = arry.length - 1; i >= 0; i--) {
let b = arry ;
b.update();
if (b.off()) {
arry.splice(i, 1);
continue;
}
// colisão bala do inimigo com jogador
if (arry === bulletEnemy && Math.hypot(
b.x - (player.x + 15), b.y - (player.y + 15)
) < 25) {
currentLives--;
arry.splice(i, 1);
if (currentLives <= 0) gameOver();
continue;
}
// colisão bala do jogador com inimigo
if (arry === bulletPlayer && enemies.some((e, j) => {
let d = Math.hypot(b.x - (e.x + 15), b.y - (e.y + 15));
if (d < 30) {
arry.splice(i, 1);
if (e.isBoss) {
e.hp--;
if (e.hp <= 0) {
enemies.splice(j, 1);
openCards();
} else {
// barra de vida do boss
ctx.fillStyle = 'red';
ctx.fillRect(e.x, e.y - 15, 160 * (e.hp / 100), 5);
ctx.fillStyle = 'white';
ctx.fillRect(e.x, e.y - 15, 160, 5);
}
} else {
killEnemy(j);
}
return true;
}
return false;
})) continue;
}
});

// desenhar tudo
ctx.clearRect(0,0,800,600);
drawRect(player.x, player.y, 30, 30, player.color);
enemies.forEach(e => drawRect(e.x, e.y, e.width, e.height, e.color));
bulletPlayer.forEach(b => b.draw());
bulletEnemy.forEach(b => b.draw());
drawText(`Vidas: ${'❤️'.repeat(currentLives)}`, 50, 30, '24px', '#f44');
drawText(`Score: ${score}`, 50, 70, '24px', '#ff0');
drawText(`Kills: ${killCount}`, 50, 100);
}

// abrir baú
function openCards() {
let cartas = [
'Vida máxima +1',
'Tiro duplo permanente',
'Espada larga (alcance 100)'
];
let div = document.getElementById('cartas');
div.style.display = 'flex';
div.innerHTML = '';
cartas.forEach((op, i) => {
let c = document.createElement('div');
c.className = 'cartao';
c.innerText = op;
c.onclick = () => {
div.style.display = 'none';
switch(i) {
case 0: maxLives++; currentLives++; break;
case 1: doubleShot = true; break;
case 2: swordRange = 100; break;
}
gameActive = true;
showingCards = false;
};
div.appendChild(c);
});
}

// loop
function loop(){requestAnimationFrame(loop);update();if(!gameActive && !showingCards)draw();}loop();
